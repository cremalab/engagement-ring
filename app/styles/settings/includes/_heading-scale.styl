heading-scale(ratio = 5, top-offset = 0, bottom-offset-ratio = 0.875, header-rank-shift = -1, min-width = null, max-width = null)
  
  min-width-query = "(min-width: {min-width})"
  if min-width is null
    min-width-query = ""

  max-width-query = "(max-width: {max-width})"
  if max-width is null
    max-width-query = ""

  conjunction = ""
  if min-width isnt null and max-width isnt null
    conjunction = "and"  

  min-max-query = "{min-width-query} {conjunction} {max-width-query}"

  if min-width isnt null or max-width isnt null
    @media {min-max-query}
      for i in (1..6)
        h{i}
          power = 6 - (i - header-rank-shift)
          size = (ratio**power)em
          font-size: size
          margin: (ratio/size)*(top-offset + 1) 0 (ratio/size)*(bottom-offset-ratio)

        $h{i}Margin
          power = 6 - (i - header-rank-shift)
          size = (ratio**power)em
          margin: (ratio/size*size)*(top-offset + 1) 0 (ratio/size)*(bottom-offset-ratio)
  else
    for i in (1..6)
      h{i}
        power = 6 - (i - header-rank-shift)
        size = (ratio**power)em
        font-size: size
        margin: (ratio/size)*(top-offset + 1) 0 (ratio/size)*(bottom-offset-ratio)

      $h{i}Margin
        power = 6 - (i - header-rank-shift)
        size = (ratio**power)em
        margin: (ratio/size*size)*(top-offset + 1) 0 (ratio/size)*(bottom-offset-ratio)